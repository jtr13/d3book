<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Update, Enter, and Exit  | D3 for R Users</title>
  <meta name="description" content="4 Update, Enter, and Exit  | D3 for R Users" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Update, Enter, and Exit  | D3 for R Users" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Update, Enter, and Exit  | D3 for R Users" />
  
  
  

<meta name="author" content="Joyce Robbins" />


<meta name="date" content="2024-04-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="d3console.html"/>
<link rel="next" href="just-enough-js.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">D3 for R Users</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to D3</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#workflow"><i class="fa fa-check"></i><b>0.1</b> Workflow</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#javascript-console"><i class="fa fa-check"></i><b>0.1.1</b> JavaScript Console</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#this-book-in-the-console"><i class="fa fa-check"></i><b>0.1.2</b> This book in the Console</a></li>
<li class="chapter" data-level="0.1.3" data-path="index.html"><a href="index.html#text-editor"><i class="fa fa-check"></i><b>0.1.3</b> Text editor</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="jump.html"><a href="jump.html"><i class="fa fa-check"></i><b>1</b> Jump in the deep end <i class="fas fa-swimmer"></i></a>
<ul>
<li class="chapter" data-level="1.1" data-path="jump.html"><a href="jump.html#get-ready"><i class="fa fa-check"></i><b>1.1</b> Get ready <i class="fas fa-forward"></i></a></li>
<li class="chapter" data-level="1.2" data-path="jump.html"><a href="jump.html#elements-tab"><i class="fa fa-check"></i><b>1.2</b> Elements tab <i class="far fa-folder"></i></a></li>
<li class="chapter" data-level="1.3" data-path="jump.html"><a href="jump.html#console-tab"><i class="fa fa-check"></i><b>1.3</b> Console tab <i class="far fa-folder"></i></a></li>
<li class="chapter" data-level="1.4" data-path="jump.html"><a href="jump.html#modify-elements"><i class="fa fa-check"></i><b>1.4</b> Modify elements <i class="fas fa-exchange-alt"></i></a></li>
<li class="chapter" data-level="1.5" data-path="jump.html"><a href="jump.html#add-transitions"><i class="fa fa-check"></i><b>1.5</b> Add transitions <i class="far fa-paper-plane"></i></a></li>
<li class="chapter" data-level="1.6" data-path="jump.html"><a href="jump.html#add-interactivity"><i class="fa fa-check"></i><b>1.6</b> Add interactivity <i class="fas fa-mouse-pointer"></i></a></li>
<li class="chapter" data-level="1.7" data-path="jump.html"><a href="jump.html#examples"><i class="fa fa-check"></i><b>1.7</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="web.html"><a href="web.html"><i class="fa fa-check"></i><b>2</b> Web tech <i class="fas fa-server"></i></a>
<ul>
<li class="chapter" data-level="2.1" data-path="web.html"><a href="web.html#html"><i class="fa fa-check"></i><b>2.1</b> HTML <i class="fab fa-html5"></i></a></li>
<li class="chapter" data-level="2.2" data-path="web.html"><a href="web.html#css"><i class="fa fa-check"></i><b>2.2</b> CSS <i class="fab fa-css3"></i></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="web.html"><a href="web.html#internal-style-sheet"><i class="fa fa-check"></i><b>2.2.1</b> Internal style sheet</a></li>
<li class="chapter" data-level="2.2.2" data-path="web.html"><a href="web.html#external-style-sheets"><i class="fa fa-check"></i><b>2.2.2</b> External style sheets</a></li>
<li class="chapter" data-level="2.2.3" data-path="web.html"><a href="web.html#inline-styling"><i class="fa fa-check"></i><b>2.2.3</b> Inline styling</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="web.html"><a href="web.html#svg"><i class="fa fa-check"></i><b>2.3</b> SVG <i class="far fa-image"></i></a></li>
<li class="chapter" data-level="2.4" data-path="web.html"><a href="web.html#javascript"><i class="fa fa-check"></i><b>2.4</b> JavaScript <i class="fab fa-js-square"></i></a></li>
<li class="chapter" data-level="2.5" data-path="web.html"><a href="web.html#d3"><i class="fa fa-check"></i><b>2.5</b> D3 <i class="far fa-chart-bar"></i></a></li>
<li class="chapter" data-level="2.6" data-path="web.html"><a href="web.html#html-tree"><i class="fa fa-check"></i><b>2.6</b> HTML tree <i class="fas fa-tree"></i></a></li>
<li class="chapter" data-level="2.7" data-path="web.html"><a href="web.html#exercise-shapes"><i class="fa fa-check"></i><b>2.7</b> Exercise <i class="fas fa-dumbbell"></i>: shapes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="d3console.html"><a href="d3console.html"><i class="fa fa-check"></i><b>3</b> Modify, Add, Remove <i class="fa-solid fa-shapes"></i></a>
<ul>
<li class="chapter" data-level="3.1" data-path="d3console.html"><a href="d3console.html#selections"><i class="fa fa-check"></i><b>3.1</b> Selections <i class="fas fa-clipboard-list"></i></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="d3console.html"><a href="d3console.html#select-by-tag"><i class="fa fa-check"></i><b>3.1.1</b> Select by tag</a></li>
<li class="chapter" data-level="3.1.2" data-path="d3console.html"><a href="d3console.html#select-by-class"><i class="fa fa-check"></i><b>3.1.2</b> Select by class</a></li>
<li class="chapter" data-level="3.1.3" data-path="d3console.html"><a href="d3console.html#select-by-id"><i class="fa fa-check"></i><b>3.1.3</b> Select by ID</a></li>
<li class="chapter" data-level="3.1.4" data-path="d3console.html"><a href="d3console.html#store-selections"><i class="fa fa-check"></i><b>3.1.4</b> Store selections</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="d3console.html"><a href="d3console.html#modify-existing-elements"><i class="fa fa-check"></i><b>3.2</b> Modify existing elements <i class="fas fa-exchange-alt"></i></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="d3console.html"><a href="d3console.html#modify-attributes"><i class="fa fa-check"></i><b>3.2.1</b> Modify attributes</a></li>
<li class="chapter" data-level="3.2.2" data-path="d3console.html"><a href="d3console.html#modify-styles"><i class="fa fa-check"></i><b>3.2.2</b> Modify styles</a></li>
<li class="chapter" data-level="3.2.3" data-path="d3console.html"><a href="d3console.html#modify-text"><i class="fa fa-check"></i><b>3.2.3</b> Modify text</a></li>
<li class="chapter" data-level="3.2.4" data-path="d3console.html"><a href="d3console.html#move-svg-text"><i class="fa fa-check"></i><b>3.2.4</b> Move SVG text</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="d3console.html"><a href="d3console.html#add-elements"><i class="fa fa-check"></i><b>3.3</b> Add elements <i class="far fa-plus-square"></i></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="d3console.html"><a href="d3console.html#html-1"><i class="fa fa-check"></i><b>3.3.1</b> HTML</a></li>
<li class="chapter" data-level="3.3.2" data-path="d3console.html"><a href="d3console.html#svg-1"><i class="fa fa-check"></i><b>3.3.2</b> SVG</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="d3console.html"><a href="d3console.html#remove-elements"><i class="fa fa-check"></i><b>3.4</b> Remove elements <i class="far fa-minus-square"></i></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="d3console.html"><a href="d3console.html#html-2"><i class="fa fa-check"></i><b>3.4.1</b> HTML</a></li>
<li class="chapter" data-level="3.4.2" data-path="d3console.html"><a href="d3console.html#svg-2"><i class="fa fa-check"></i><b>3.4.2</b> SVG</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="d3console.html"><a href="d3console.html#exercise-green-circles"><i class="fa fa-check"></i><b>3.5</b> Exercise <i class="fas fa-dumbbell"></i>: green circles</a></li>
<li class="chapter" data-level="3.6" data-path="d3console.html"><a href="d3console.html#exercise-blue-circles"><i class="fa fa-check"></i><b>3.6</b> Exercise <i class="fas fa-dumbbell"></i> <i class="fas fa-dumbbell"></i>: blue circles</a></li>
<li class="chapter" data-level="3.7" data-path="d3console.html"><a href="d3console.html#bind-data-finally"><i class="fa fa-check"></i><b>3.7</b> Bind data… <em>finally!</em> <i class="fas fa-table"></i></a></li>
<li class="chapter" data-level="3.8" data-path="d3console.html"><a href="d3console.html#exercise-data-bind"><i class="fa fa-check"></i><b>3.8</b> Exercise <i class="fas fa-dumbbell"></i>: data bind</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html"><i class="fa fa-check"></i><b>4</b> Update, Enter, and Exit <i class="fa fa-refresh"></i></a>
<ul>
<li class="chapter" data-level="4.1" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#lecture-slides"><i class="fa fa-check"></i><b>4.1</b> Lecture slides <i class="fa fa-television"></i></a></li>
<li class="chapter" data-level="4.2" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#use-exit-selection-to-remove-elements"><i class="fa fa-check"></i><b>4.2</b> Use exit selection to remove elements <i class="far fa-minus-square"></i></a></li>
<li class="chapter" data-level="4.3" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#use-enter-selection-to-add-elements"><i class="fa fa-check"></i><b>4.3</b> Use enter selection to add elements <i class="far fa-plus-square"></i></a></li>
<li class="chapter" data-level="4.4" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#data-enter-append-sequence"><i class="fa fa-check"></i><b>4.4</b> Data / enter / append sequence <i class="fa fa-table"></i></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#labels"><i class="fa fa-check"></i><b>4.4.1</b> Labels</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#exercise-horizontal-bar-chart"><i class="fa fa-check"></i><b>4.5</b> Exercise <i class="fas fa-dumbbell"></i>: horizontal bar chart</a></li>
<li class="chapter" data-level="4.6" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#merge-selections"><i class="fa fa-check"></i><b>4.6</b> Merge selections <i class="fa fa-code-fork"></i></a></li>
<li class="chapter" data-level="4.7" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#exercise-merge"><i class="fa fa-check"></i><b>4.7</b> Exercise <i class="fas fa-dumbbell"></i>: merge</a></li>
<li class="chapter" data-level="4.8" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#groups"><i class="fa fa-check"></i><b>4.8</b> Groups <i class="fa fa-object-group"></i></a></li>
<li class="chapter" data-level="4.9" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#general-update-pattern-with-merge"><i class="fa fa-check"></i><b>4.9</b> General Update Pattern (with merge)</a></li>
<li class="chapter" data-level="4.10" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#general-update-pattern-with-join"><i class="fa fa-check"></i><b>4.10</b> General Update Pattern (with join)</a></li>
<li class="chapter" data-level="4.11" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#exercise-functions"><i class="fa fa-check"></i><b>4.11</b> Exercise: <i class="fas fa-dumbbell"></i>: functions</a></li>
<li class="chapter" data-level="4.12" data-path="update-enter-and-exit.html"><a href="update-enter-and-exit.html#exercise-vertical-bar-chart"><i class="fa fa-check"></i><b>4.12</b> Exercise <i class="fas fa-dumbbell"></i>: vertical bar chart</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="just-enough-js.html"><a href="just-enough-js.html"><i class="fa fa-check"></i><b>5</b> Just Enough JS <i class="fab fa-js-square"></i></a>
<ul>
<li class="chapter" data-level="5.1" data-path="just-enough-js.html"><a href="just-enough-js.html#arrays-of-arrays"><i class="fa fa-check"></i><b>5.1</b> Arrays of arrays</a></li>
<li class="chapter" data-level="5.2" data-path="just-enough-js.html"><a href="just-enough-js.html#arrays-of-objects"><i class="fa fa-check"></i><b>5.2</b> Arrays of objects</a></li>
<li class="chapter" data-level="5.3" data-path="just-enough-js.html"><a href="just-enough-js.html#map"><i class="fa fa-check"></i><b>5.3</b> <code>.map()</code></a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="just-enough-js.html"><a href="just-enough-js.html#simple-arrays"><i class="fa fa-check"></i><b>5.3.1</b> Simple arrays</a></li>
<li class="chapter" data-level="5.3.2" data-path="just-enough-js.html"><a href="just-enough-js.html#arrays-of-arrays-1"><i class="fa fa-check"></i><b>5.3.2</b> Arrays of arrays</a></li>
<li class="chapter" data-level="5.3.3" data-path="just-enough-js.html"><a href="just-enough-js.html#create-arrays-of-objects"><i class="fa fa-check"></i><b>5.3.3</b> Create arrays of objects</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="just-enough-js.html"><a href="just-enough-js.html#d3-sorting"><i class="fa fa-check"></i><b>5.4</b> D3 sorting</a></li>
<li class="chapter" data-level="5.5" data-path="just-enough-js.html"><a href="just-enough-js.html#d3-statistics"><i class="fa fa-check"></i><b>5.5</b> D3 statistics</a></li>
<li class="chapter" data-level="5.6" data-path="just-enough-js.html"><a href="just-enough-js.html#d3-.map"><i class="fa fa-check"></i><b>5.6</b> D3 + <code>.map()</code></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="scales-and-axes.html"><a href="scales-and-axes.html"><i class="fa fa-check"></i><b>6</b> Scales and Axes <i class="fa fa-arrows"></i></a>
<ul>
<li class="chapter" data-level="6.1" data-path="scales-and-axes.html"><a href="scales-and-axes.html#scales"><i class="fa fa-check"></i><b>6.1</b> Scales</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="scales-and-axes.html"><a href="scales-and-axes.html#lecture-slides-1"><i class="fa fa-check"></i><b>6.1.1</b> Lecture slides <i class="fa fa-television"></i></a></li>
<li class="chapter" data-level="6.1.2" data-path="scales-and-axes.html"><a href="scales-and-axes.html#practice"><i class="fa fa-check"></i><b>6.1.2</b> Practice</a></li>
<li class="chapter" data-level="6.1.3" data-path="scales-and-axes.html"><a href="scales-and-axes.html#bar-chart"><i class="fa fa-check"></i><b>6.1.3</b> Bar chart</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="scales-and-axes.html"><a href="scales-and-axes.html#margins"><i class="fa fa-check"></i><b>6.2</b> Margins</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="scales-and-axes.html"><a href="scales-and-axes.html#lecture-slides-2"><i class="fa fa-check"></i><b>6.2.1</b> Lecture slides <i class="fa fa-television"></i></a></li>
<li class="chapter" data-level="6.2.2" data-path="scales-and-axes.html"><a href="scales-and-axes.html#bar-chart-with-margins"><i class="fa fa-check"></i><b>6.2.2</b> Bar chart with margins</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="scales-and-axes.html"><a href="scales-and-axes.html#axes"><i class="fa fa-check"></i><b>6.3</b> Axes</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="scales-and-axes.html"><a href="scales-and-axes.html#lecture-slides-3"><i class="fa fa-check"></i><b>6.3.1</b> Lecture slides <i class="fa fa-television"></i></a></li>
<li class="chapter" data-level="6.3.2" data-path="scales-and-axes.html"><a href="scales-and-axes.html#bar-chart-with-axes"><i class="fa fa-check"></i><b>6.3.2</b> Bar chart with axes</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="scales-and-axes.html"><a href="scales-and-axes.html#bar-chart-with-categorical-labels"><i class="fa fa-check"></i><b>6.4</b> Bar chart with categorical labels</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interactivity.html"><a href="interactivity.html"><i class="fa fa-check"></i><b>7</b> Interactivity <i class="fas fa-mouse-pointer"></i></a>
<ul>
<li class="chapter" data-level="7.1" data-path="interactivity.html"><a href="interactivity.html#bar-chart-example"><i class="fa fa-check"></i><b>7.1</b> Bar chart example</a></li>
<li class="chapter" data-level="7.2" data-path="interactivity.html"><a href="interactivity.html#binding-event-listeners"><i class="fa fa-check"></i><b>7.2</b> Binding event listeners</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="interactivity.html"><a href="interactivity.html#do-something-unrelated-to-the-element-that-received-the-event"><i class="fa fa-check"></i><b>7.2.1</b> Do something unrelated to the element that received the event</a></li>
<li class="chapter" data-level="7.2.2" data-path="interactivity.html"><a href="interactivity.html#change-an-attribute-of-the-element-that-received-the-event"><i class="fa fa-check"></i><b>7.2.2</b> Change an attribute of the element that received the event</a></li>
<li class="chapter" data-level="7.2.3" data-path="interactivity.html"><a href="interactivity.html#get-the-value-of-an-attribute-of-the-element-that-received-the-event"><i class="fa fa-check"></i><b>7.2.3</b> Get the value of an attribute of the element that received the event</a></li>
<li class="chapter" data-level="7.2.4" data-path="interactivity.html"><a href="interactivity.html#do-something-with-the-data-bound-to-the-element-that-received-the-event"><i class="fa fa-check"></i><b>7.2.4</b> Do something with the data bound to the element that received the event</a></li>
<li class="chapter" data-level="7.2.5" data-path="interactivity.html"><a href="interactivity.html#get-the-svg-location-of-the-event"><i class="fa fa-check"></i><b>7.2.5</b> Get the svg location of the event</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="interactivity.html"><a href="interactivity.html#separating-the-function-and-event-listener"><i class="fa fa-check"></i><b>7.3</b> Separating the function and event listener</a></li>
<li class="chapter" data-level="7.4" data-path="interactivity.html"><a href="interactivity.html#buttons"><i class="fa fa-check"></i><b>7.4</b> Buttons</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="interactivity.html"><a href="interactivity.html#html-text-as-buttons"><i class="fa fa-check"></i><b>7.4.1</b> HTML text as buttons</a></li>
<li class="chapter" data-level="7.4.2" data-path="interactivity.html"><a href="interactivity.html#radio-buttons"><i class="fa fa-check"></i><b>7.4.2</b> Radio buttons</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="interactivity.html"><a href="interactivity.html#dependent-event-listeners"><i class="fa fa-check"></i><b>7.5</b> Dependent event listeners</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="interactivity.html"><a href="interactivity.html#global-variable-example"><i class="fa fa-check"></i><b>7.5.1</b> Global variable example</a></li>
<li class="chapter" data-level="7.5.2" data-path="interactivity.html"><a href="interactivity.html#turn-off-event-listener"><i class="fa fa-check"></i><b>7.5.2</b> Turn off event listener</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="transitions.html"><a href="transitions.html"><i class="fa fa-check"></i><b>8</b> Transitions <i class="far fa-paper-plane"></i></a>
<ul>
<li class="chapter" data-level="8.1" data-path="transitions.html"><a href="transitions.html#examples-1"><i class="fa fa-check"></i><b>8.1</b> Examples</a></li>
<li class="chapter" data-level="8.2" data-path="transitions.html"><a href="transitions.html#do-this"><i class="fa fa-check"></i><b>8.2</b> Do this</a></li>
<li class="chapter" data-level="8.3" data-path="transitions.html"><a href="transitions.html#not-this"><i class="fa fa-check"></i><b>8.3</b> Not this</a></li>
<li class="chapter" data-level="8.4" data-path="transitions.html"><a href="transitions.html#strategy"><i class="fa fa-check"></i><b>8.4</b> Strategy</a></li>
<li class="chapter" data-level="8.5" data-path="transitions.html"><a href="transitions.html#exercise-bar-chart-with-transitions"><i class="fa fa-check"></i><b>8.5</b> Exercise <i class="fas fa-dumbbell"></i>: Bar chart with transitions</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="object.html"><a href="object.html"><i class="fa fa-check"></i><b>9</b> Object Constancy <i class="fa fa-object-ungroup"></i></a>
<ul>
<li class="chapter" data-level="9.1" data-path="object.html"><a href="object.html#lecture-slides-4"><i class="fa fa-check"></i><b>9.1</b> Lecture slides <i class="fa fa-television"></i></a></li>
<li class="chapter" data-level="9.2" data-path="object.html"><a href="object.html#no-object-constancy"><i class="fa fa-check"></i><b>9.2</b> No object constancy</a></li>
<li class="chapter" data-level="9.3" data-path="object.html"><a href="object.html#object-constancy"><i class="fa fa-check"></i><b>9.3</b> Object constancy</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="object.html"><a href="object.html#practice-joining-data-by-key"><i class="fa fa-check"></i><b>9.3.1</b> Practice joining data by key</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="reading-files.html"><a href="reading-files.html"><i class="fa fa-check"></i><b>10</b> Reading files <i class="fa fa-file-text-o"></i></a>
<ul>
<li class="chapter" data-level="10.1" data-path="reading-files.html"><a href="reading-files.html#promises"><i class="fa fa-check"></i><b>10.1</b> Promises</a></li>
<li class="chapter" data-level="10.2" data-path="reading-files.html"><a href="reading-files.html#local-server"><i class="fa fa-check"></i><b>10.2</b> Local server</a></li>
<li class="chapter" data-level="10.3" data-path="reading-files.html"><a href="reading-files.html#other-local-options"><i class="fa fa-check"></i><b>10.3</b> Other local options</a></li>
<li class="chapter" data-level="10.4" data-path="reading-files.html"><a href="reading-files.html#hosting-online"><i class="fa fa-check"></i><b>10.4</b> Hosting online</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="share-d3-online.html"><a href="share-d3-online.html"><i class="fa fa-check"></i><b>11</b> Share D3 online <i class="fa share-square"></i></a>
<ul>
<li class="chapter" data-level="11.1" data-path="share-d3-online.html"><a href="share-d3-online.html#quarto"><i class="fa fa-check"></i><b>11.1</b> Quarto</a>
<ul>
<li class="chapter" data-level="" data-path="share-d3-online.html"><a href="share-d3-online.html#separate-.js-file"><i class="fa fa-check"></i>Separate <code>.js</code> file</a></li>
<li class="chapter" data-level="" data-path="share-d3-online.html"><a href="share-d3-online.html#iframe"><i class="fa fa-check"></i>iframe</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="share-d3-online.html"><a href="share-d3-online.html#observable"><i class="fa fa-check"></i><b>11.2</b> Observable</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="line-charts.html"><a href="line-charts.html"><i class="fa fa-check"></i><b>12</b> Line charts <i class="fa fa-line-chart"></i></a>
<ul>
<li class="chapter" data-level="12.1" data-path="line-charts.html"><a href="line-charts.html#lecture-slides-5"><i class="fa fa-check"></i><b>12.1</b> Lecture slides <i class="fa fa-television"></i></a></li>
<li class="chapter" data-level="12.2" data-path="line-charts.html"><a href="line-charts.html#svg-line-element"><i class="fa fa-check"></i><b>12.2</b> SVG <code>&lt;line&gt;</code> element</a></li>
<li class="chapter" data-level="12.3" data-path="line-charts.html"><a href="line-charts.html#svg-path-element"><i class="fa fa-check"></i><b>12.3</b> SVG <code>&lt;path&gt;</code> element</a></li>
<li class="chapter" data-level="12.4" data-path="line-charts.html"><a href="line-charts.html#data-for-line-chart"><i class="fa fa-check"></i><b>12.4</b> Data for line chart</a></li>
<li class="chapter" data-level="12.5" data-path="line-charts.html"><a href="line-charts.html#create-a-line-generator"><i class="fa fa-check"></i><b>12.5</b> Create a line generator</a></li>
<li class="chapter" data-level="12.6" data-path="line-charts.html"><a href="line-charts.html#put-the-line-generator-to-work"><i class="fa fa-check"></i><b>12.6</b> Put the line generator to work</a></li>
<li class="chapter" data-level="12.7" data-path="line-charts.html"><a href="line-charts.html#additional-resources"><i class="fa fa-check"></i><b>12.7</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="layouts.html"><a href="layouts.html"><i class="fa fa-check"></i><b>13</b> Layouts <i class="fa fa-bar-chart"></i></a>
<ul>
<li class="chapter" data-level="13.1" data-path="layouts.html"><a href="layouts.html#lecture-slides-6"><i class="fa fa-check"></i><b>13.1</b> Lecture slides <i class="fa fa-television"></i></a></li>
<li class="chapter" data-level="13.2" data-path="layouts.html"><a href="layouts.html#set-up-data-and-stack-method"><i class="fa fa-check"></i><b>13.2</b> Set up data and stack method</a></li>
<li class="chapter" data-level="13.3" data-path="layouts.html"><a href="layouts.html#set-up-scales"><i class="fa fa-check"></i><b>13.3</b> Set up scales</a></li>
<li class="chapter" data-level="13.4" data-path="layouts.html"><a href="layouts.html#add-groups"><i class="fa fa-check"></i><b>13.4</b> Add groups</a></li>
<li class="chapter" data-level="13.5" data-path="layouts.html"><a href="layouts.html#add-rectangles"><i class="fa fa-check"></i><b>13.5</b> Add rectangles</a></li>
<li class="chapter" data-level="13.6" data-path="layouts.html"><a href="layouts.html#get-the-code"><i class="fa fa-check"></i><b>13.6</b> Get the code</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="general-advice.html"><a href="general-advice.html"><i class="fa fa-check"></i><b>14</b> General Advice <i class="fa fa-bug"></i></a>
<ul>
<li class="chapter" data-level="14.1" data-path="general-advice.html"><a href="general-advice.html#debugging-tips"><i class="fa fa-check"></i><b>14.1</b> Debugging Tips</a></li>
<li class="chapter" data-level="14.2" data-path="general-advice.html"><a href="general-advice.html#other"><i class="fa fa-check"></i><b>14.2</b> Other</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i><b>15</b> Solutions <i class="fa fa-check-square-o"></i></a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#web-tech-shapes"><i class="fa fa-check"></i>Web tech: shapes</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#d3-in-the-console-green-circles"><i class="fa fa-check"></i>D3 in the Console: green circles</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#d3-in-the-console-blue-circles"><i class="fa fa-check"></i>D3 in the Console: blue circles</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#d3-in-the-console-data-bind"><i class="fa fa-check"></i>D3 in the Console: data bind</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#update-enter-and-exit-horizontal-bar-chart"><i class="fa fa-check"></i>Update, Enter, and Exit: horizontal bar chart</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#update-enter-and-exit-merge"><i class="fa fa-check"></i>Update, Enter, and Exit: merge</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#update-enter-and-exit-functions"><i class="fa fa-check"></i>Update, Enter, and Exit: functions</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#update-enter-and-exit-vertical-bar-chart"><i class="fa fa-check"></i>Update, Enter, and Exit: vertical bar chart</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#transitions-bar-chart-with-transitions"><i class="fa fa-check"></i>Transitions: bar chart with transitions</a></li>
</ul></li>
<li class="part"><span><b>I Examples</b></span></li>
<li class="chapter" data-level="16" data-path="correlation-coefficient.html"><a href="correlation-coefficient.html"><i class="fa fa-check"></i><b>16</b> Correlation Coefficient</a></li>
<li class="chapter" data-level="17" data-path="spearman-rank-correlation-coefficient.html"><a href="spearman-rank-correlation-coefficient.html"><i class="fa fa-check"></i><b>17</b> Spearman Rank Correlation Coefficient</a></li>
<li class="chapter" data-level="18" data-path="population-density.html"><a href="population-density.html"><i class="fa fa-check"></i><b>18</b> Population Density</a></li>
<li class="chapter" data-level="19" data-path="weather-forecast.html"><a href="weather-forecast.html"><i class="fa fa-check"></i><b>19</b> Weather forecast</a></li>
<li class="part"><span><b>II Appendices</b></span></li>
<li class="chapter" data-level="20" data-path="appendix-advanced-css.html"><a href="appendix-advanced-css.html"><i class="fa fa-check"></i><b>20</b> Appendix: advanced CSS</a>
<ul>
<li class="chapter" data-level="20.1" data-path="appendix-advanced-css.html"><a href="appendix-advanced-css.html#buttons-1"><i class="fa fa-check"></i><b>20.1</b> Buttons</a>
<ul>
<li class="chapter" data-level="20.1.1" data-path="appendix-advanced-css.html"><a href="appendix-advanced-css.html#active"><i class="fa fa-check"></i><b>20.1.1</b> <code>.active</code></a></li>
<li class="chapter" data-level="20.1.2" data-path="appendix-advanced-css.html"><a href="appendix-advanced-css.html#active-1"><i class="fa fa-check"></i><b>20.1.2</b> <code>:active</code></a></li>
<li class="chapter" data-level="20.1.3" data-path="appendix-advanced-css.html"><a href="appendix-advanced-css.html#focus"><i class="fa fa-check"></i><b>20.1.3</b> <code>:focus</code></a></li>
<li class="chapter" data-level="20.1.4" data-path="appendix-advanced-css.html"><a href="appendix-advanced-css.html#hover"><i class="fa fa-check"></i><b>20.1.4</b> <code>:hover</code></a></li>
<li class="chapter" data-level="20.1.5" data-path="appendix-advanced-css.html"><a href="appendix-advanced-css.html#example"><i class="fa fa-check"></i><b>20.1.5</b> Example</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">D3 for R Users</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="update-enter-and-exit" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Update, Enter, and Exit <i class="fa fa-refresh"></i><a href="update-enter-and-exit.html#update-enter-and-exit" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<script src="https://d3js.org/d3.v7.js"></script>
<p>Read: <em>IDVW2</em>, Chapter 9, pp. 178-184; Chapter 12, pp. 231-249</p>
<div id="lecture-slides" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Lecture slides <i class="fa fa-television"></i><a href="update-enter-and-exit.html#lecture-slides" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://github.com/jtr13/d3book/blob/main/pdfs/databind.pdf" target="_blank">D3 Data Bind</a></p>
<p><a href="#data-enter-append">Jump to data/enter/append</a></p>
<p><a href="update-enter-and-exit.html#general-update-pattern-with-merge">Jump to general update pattern</a></p>
</div>
<div id="use-exit-selection-to-remove-elements" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Use exit selection to remove elements <i class="far fa-minus-square"></i><a href="update-enter-and-exit.html#use-exit-selection-to-remove-elements" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>a.k.a. more DOM elements than data values</em></p>
<p>We’ll start with six circles and remove some.</p>
<p>Open <a href="code/six_blue_circles.html" target="_blank">six_blue_circles.html</a> in Chrome and open the JavaScript Console.</p>
<p>Let’s bind four data values to the six circles:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb54-1"><a href="update-enter-and-exit.html#cb54-1" tabindex="-1"></a>d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb54-2"><a href="update-enter-and-exit.html#cb54-2" tabindex="-1"></a>  <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;circle&quot;</span>)</span>
<span id="cb54-3"><a href="update-enter-and-exit.html#cb54-3" tabindex="-1"></a>  <span class="op">.</span><span class="fu">data</span>([<span class="dv">123</span><span class="op">,</span> <span class="dv">52</span><span class="op">,</span> <span class="dv">232</span><span class="op">,</span> <span class="dv">90</span>])<span class="op">;</span></span></code></pre></div>
<p>Click the black triangle to view the <code>_enter</code>, <code>_exit</code>, and <code>_groups</code> fields.</p>
<p>We can store the selection in a variable:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb55-1"><a href="update-enter-and-exit.html#cb55-1" tabindex="-1"></a><span class="kw">const</span> circ <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb55-2"><a href="update-enter-and-exit.html#cb55-2" tabindex="-1"></a>  <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;circle&quot;</span>)</span>
<span id="cb55-3"><a href="update-enter-and-exit.html#cb55-3" tabindex="-1"></a>  <span class="op">.</span><span class="fu">data</span>([<span class="dv">123</span><span class="op">,</span> <span class="dv">52</span><span class="op">,</span> <span class="dv">232</span><span class="op">,</span> <span class="dv">90</span>])<span class="op">;</span></span></code></pre></div>
<p>Let’s look at the exit selection:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb56-1"><a href="update-enter-and-exit.html#cb56-1" tabindex="-1"></a>circ<span class="op">.</span><span class="fu">exit</span>()<span class="op">;</span></span></code></pre></div>
<p>Try this:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb57-1"><a href="update-enter-and-exit.html#cb57-1" tabindex="-1"></a>circ<span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;red&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>What happened and why?</p>
<p>Now try this:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb58-1"><a href="update-enter-and-exit.html#cb58-1" tabindex="-1"></a>circ<span class="op">.</span><span class="fu">exit</span>()<span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;purple&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>What happened and why?</p>
<p>What do you think this will do? Try it.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb59-1"><a href="update-enter-and-exit.html#cb59-1" tabindex="-1"></a>circ<span class="op">.</span><span class="fu">exit</span>()<span class="op">.</span><span class="fu">transition</span>()<span class="op">.</span><span class="fu">duration</span>(<span class="dv">2000</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span></code></pre></div>
<p>Create a new variable <code>circ2</code> and compare it to <code>circ</code>:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb60-1"><a href="update-enter-and-exit.html#cb60-1" tabindex="-1"></a><span class="kw">const</span> circ2 <span class="op">=</span> d3<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;circle&quot;</span>)<span class="op">;</span></span>
<span id="cb60-2"><a href="update-enter-and-exit.html#cb60-2" tabindex="-1"></a></span>
<span id="cb60-3"><a href="update-enter-and-exit.html#cb60-3" tabindex="-1"></a>circ<span class="op">.</span><span class="fu">data</span>()<span class="op">;</span></span>
<span id="cb60-4"><a href="update-enter-and-exit.html#cb60-4" tabindex="-1"></a></span>
<span id="cb60-5"><a href="update-enter-and-exit.html#cb60-5" tabindex="-1"></a>circ2<span class="op">.</span><span class="fu">data</span>()<span class="op">;</span></span>
<span id="cb60-6"><a href="update-enter-and-exit.html#cb60-6" tabindex="-1"></a></span>
<span id="cb60-7"><a href="update-enter-and-exit.html#cb60-7" tabindex="-1"></a>circ<span class="op">.</span><span class="fu">exit</span>()<span class="op">;</span></span>
<span id="cb60-8"><a href="update-enter-and-exit.html#cb60-8" tabindex="-1"></a></span>
<span id="cb60-9"><a href="update-enter-and-exit.html#cb60-9" tabindex="-1"></a>circ2<span class="op">.</span><span class="fu">exit</span>()<span class="op">;</span></span></code></pre></div>
<p>What’s going on?</p>
</div>
<div id="use-enter-selection-to-add-elements" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Use enter selection to add elements <i class="far fa-plus-square"></i><a href="update-enter-and-exit.html#use-enter-selection-to-add-elements" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>a.k.a. more data values than DOM elements</em></p>
<p>We’ll start with <a href="code/six_blue_circles.html" target="_blank">six_blue_circles.html</a> in Chrome and add some circles.</p>
<p>First, let’s bind new data to the circles:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb61-1"><a href="update-enter-and-exit.html#cb61-1" tabindex="-1"></a><span class="kw">const</span> circ <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb61-2"><a href="update-enter-and-exit.html#cb61-2" tabindex="-1"></a>  <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;circle&quot;</span>)</span>
<span id="cb61-3"><a href="update-enter-and-exit.html#cb61-3" tabindex="-1"></a>  <span class="op">.</span><span class="fu">data</span>([<span class="dv">123</span><span class="op">,</span> <span class="dv">52</span><span class="op">,</span> <span class="dv">232</span><span class="op">,</span> <span class="dv">90</span><span class="op">,</span> <span class="dv">34</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">189</span><span class="op">,</span> <span class="dv">110</span>])<span class="op">;</span></span></code></pre></div>
<p>And look at the enter selection:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb62-1"><a href="update-enter-and-exit.html#cb62-1" tabindex="-1"></a>circ<span class="op">.</span><span class="fu">enter</span>()<span class="op">;</span></span></code></pre></div>
<p>How many placeholders are in the enter selection?</p>
<p>Let’s add circles for each of these placeholders:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb63-1"><a href="update-enter-and-exit.html#cb63-1" tabindex="-1"></a>circ<span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb63-2"><a href="update-enter-and-exit.html#cb63-2" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;circle&quot;</span>)</span>
<span id="cb63-3"><a href="update-enter-and-exit.html#cb63-3" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;cx&quot;</span><span class="op">,</span> <span class="st">&quot;100&quot;</span>)</span>
<span id="cb63-4"><a href="update-enter-and-exit.html#cb63-4" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;cy&quot;</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> i <span class="op">*</span> <span class="dv">50</span> <span class="op">+</span> <span class="dv">25</span>)</span>
<span id="cb63-5"><a href="update-enter-and-exit.html#cb63-5" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;r&quot;</span><span class="op">,</span> <span class="st">&quot;20&quot;</span>)</span>
<span id="cb63-6"><a href="update-enter-and-exit.html#cb63-6" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;blue&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>Try this:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb64-1"><a href="update-enter-and-exit.html#cb64-1" tabindex="-1"></a>circ<span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb64-2"><a href="update-enter-and-exit.html#cb64-2" tabindex="-1"></a>  <span class="op">.</span><span class="fu">duration</span>(<span class="dv">3000</span>)</span>
<span id="cb64-3"><a href="update-enter-and-exit.html#cb64-3" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;cx&quot;</span><span class="op">,</span> <span class="st">&quot;400&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>What do you need to do to act on <em>all</em> of the circles?</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb65-1"><a href="update-enter-and-exit.html#cb65-1" tabindex="-1"></a>d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb65-2"><a href="update-enter-and-exit.html#cb65-2" tabindex="-1"></a>  <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;circle&quot;</span>)</span>
<span id="cb65-3"><a href="update-enter-and-exit.html#cb65-3" tabindex="-1"></a>  <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb65-4"><a href="update-enter-and-exit.html#cb65-4" tabindex="-1"></a>  <span class="op">.</span><span class="fu">duration</span>(<span class="dv">2000</span>)</span>
<span id="cb65-5"><a href="update-enter-and-exit.html#cb65-5" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;cy&quot;</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> (i <span class="op">*</span> <span class="dv">50</span>) <span class="op">+</span> <span class="dv">25</span>)</span>
<span id="cb65-6"><a href="update-enter-and-exit.html#cb65-6" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;cx&quot;</span><span class="op">,</span> <span class="st">&quot;200&quot;</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div id="data-enter-append-sequence" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Data / enter / append sequence <i class="fa fa-table"></i><a href="update-enter-and-exit.html#data-enter-append-sequence" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ll start with nothing–not even an SVG–and add elements with the data / enter / append sequence.</p>
<p>Work in the Console on this page (<a href="index.html#this-book-console">help</a>).</p>
<blockquote>
<p><i class="fa fa-hand-o-right"></i> <em>Open the JavaScript Console</em> <i class="fa fa-terminal"></i></p>
</blockquote>
<p>The SVG will be added here:</p>
<p><br></p>
<div id="dea">

</div>
<div class="sourceCode" id="cb66"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb66-1"><a href="update-enter-and-exit.html#cb66-1" tabindex="-1"></a>d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;div#dea&quot;</span>)</span>
<span id="cb66-2"><a href="update-enter-and-exit.html#cb66-2" tabindex="-1"></a>  <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb66-3"><a href="update-enter-and-exit.html#cb66-3" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;width&quot;</span><span class="op">,</span> <span class="st">&quot;400&quot;</span>)</span>
<span id="cb66-4"><a href="update-enter-and-exit.html#cb66-4" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;height&quot;</span><span class="op">,</span> <span class="st">&quot;250&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>Create an array of values:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb67-1"><a href="update-enter-and-exit.html#cb67-1" tabindex="-1"></a><span class="kw">const</span> specialdata <span class="op">=</span> [<span class="dv">75</span><span class="op">,</span> <span class="dv">150</span><span class="op">,</span> <span class="dv">200</span>]<span class="op">;</span></span></code></pre></div>
<p>Add rectangles:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb68-1"><a href="update-enter-and-exit.html#cb68-1" tabindex="-1"></a>d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb68-2"><a href="update-enter-and-exit.html#cb68-2" tabindex="-1"></a>  <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb68-3"><a href="update-enter-and-exit.html#cb68-3" tabindex="-1"></a>  <span class="op">.</span><span class="fu">data</span>(specialdata)</span>
<span id="cb68-4"><a href="update-enter-and-exit.html#cb68-4" tabindex="-1"></a>  <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb68-5"><a href="update-enter-and-exit.html#cb68-5" tabindex="-1"></a>  <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb68-6"><a href="update-enter-and-exit.html#cb68-6" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)</span>
<span id="cb68-7"><a href="update-enter-and-exit.html#cb68-7" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;y&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)</span>
<span id="cb68-8"><a href="update-enter-and-exit.html#cb68-8" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;width&quot;</span><span class="op">,</span> <span class="st">&quot;50&quot;</span>)</span>
<span id="cb68-9"><a href="update-enter-and-exit.html#cb68-9" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;height&quot;</span><span class="op">,</span> <span class="st">&quot;30&quot;</span>)</span>
<span id="cb68-10"><a href="update-enter-and-exit.html#cb68-10" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;pink&quot;</span>)<span class="op">;</span></span></code></pre></div>
<div id="labels" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Labels<a href="update-enter-and-exit.html#labels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note that we can also label the rectangles with the data value:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb69-1"><a href="update-enter-and-exit.html#cb69-1" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb69-2"><a href="update-enter-and-exit.html#cb69-2" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;text&quot;</span>)</span>
<span id="cb69-3"><a href="update-enter-and-exit.html#cb69-3" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(specialdata)</span>
<span id="cb69-4"><a href="update-enter-and-exit.html#cb69-4" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb69-5"><a href="update-enter-and-exit.html#cb69-5" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;text&quot;</span>)</span>
<span id="cb69-6"><a href="update-enter-and-exit.html#cb69-6" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d <span class="op">+</span> <span class="dv">25</span>)</span>
<span id="cb69-7"><a href="update-enter-and-exit.html#cb69-7" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;y&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d <span class="op">+</span> <span class="dv">25</span>)</span>
<span id="cb69-8"><a href="update-enter-and-exit.html#cb69-8" tabindex="-1"></a>    <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d)</span>
<span id="cb69-9"><a href="update-enter-and-exit.html#cb69-9" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb69-10"><a href="update-enter-and-exit.html#cb69-10" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;text-anchor&quot;</span><span class="op">,</span> <span class="st">&quot;middle&quot;</span>)<span class="op">;</span></span></code></pre></div>
</div>
</div>
<div id="exercise-horizontal-bar-chart" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Exercise <i class="fas fa-dumbbell"></i>: horizontal bar chart<a href="update-enter-and-exit.html#exercise-horizontal-bar-chart" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Save a copy of <a href="https://raw.githubusercontent.com/jtr13/d3book/main/code/bar_chart_exercise.html" target="_blank">this exercise</a> and open it in your text editor.</li>
</ol>
<p>Create a horizontal bar chart with bar widths equal to the data values stored in <code>bardata</code>. Do so by replacing all the “ADD’s” with constants or functions and then uncommenting those lines.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb70-1"><a href="update-enter-and-exit.html#cb70-1" tabindex="-1"></a>    <span class="kw">const</span> bardata <span class="op">=</span> [<span class="dv">300</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">150</span><span class="op">,</span> <span class="dv">225</span><span class="op">,</span> <span class="dv">75</span><span class="op">,</span> <span class="dv">275</span>]<span class="op">;</span></span></code></pre></div>
<p>It should look like this:</p>
<p><img src="images/barchart.png" width="50%" /></p>
<p><a href="solutions.html#update-enter-and-exit-horizontal-bar-chart">Solution</a></p>
</div>
<div id="merge-selections" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Merge selections <i class="fa fa-code-fork"></i><a href="update-enter-and-exit.html#merge-selections" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We now know how to work separately with the update, enter, and exit selections. Often in practice we wish to do the same thing or almost the same thing with the enter and update selections. That is where <code>.merge()</code> comes in. If we merge the update and enter selections we don’t have to repeat our code.</p>
<p>Open <a href="code/six_blue_circles.html" target="_blank">six_blue_circles.html</a> in Chrome.</p>
<p>Run the following code in the Console:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb71-1"><a href="update-enter-and-exit.html#cb71-1" tabindex="-1"></a><span class="kw">const</span> newdata <span class="op">=</span> [<span class="dv">123</span><span class="op">,</span> <span class="dv">52</span><span class="op">,</span> <span class="dv">232</span><span class="op">,</span> <span class="dv">90</span><span class="op">,</span> <span class="dv">34</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">189</span><span class="op">,</span> <span class="dv">110</span>]<span class="op">;</span></span>
<span id="cb71-2"><a href="update-enter-and-exit.html#cb71-2" tabindex="-1"></a><span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)<span class="op">;</span></span>
<span id="cb71-3"><a href="update-enter-and-exit.html#cb71-3" tabindex="-1"></a><span class="kw">const</span> circ <span class="op">=</span> svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;circle&quot;</span>)</span>
<span id="cb71-4"><a href="update-enter-and-exit.html#cb71-4" tabindex="-1"></a>  <span class="op">.</span><span class="fu">data</span>(newdata)<span class="op">;</span></span>
<span id="cb71-5"><a href="update-enter-and-exit.html#cb71-5" tabindex="-1"></a>  </span>
<span id="cb71-6"><a href="update-enter-and-exit.html#cb71-6" tabindex="-1"></a>circ<span class="op">.</span><span class="fu">enter</span>()  <span class="co">// 2 placeholders</span></span>
<span id="cb71-7"><a href="update-enter-and-exit.html#cb71-7" tabindex="-1"></a>  <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;circle&quot;</span>)  <span class="co">// placeholders -&gt; circles</span></span>
<span id="cb71-8"><a href="update-enter-and-exit.html#cb71-8" tabindex="-1"></a>     <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;cx&quot;</span><span class="op">,</span> <span class="st">&quot;100&quot;</span>)  <span class="co">// acts on enter selection only</span></span>
<span id="cb71-9"><a href="update-enter-and-exit.html#cb71-9" tabindex="-1"></a>     <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;cy&quot;</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> (i <span class="op">-</span> <span class="dv">5</span>) <span class="op">*</span> <span class="dv">50</span>)</span>
<span id="cb71-10"><a href="update-enter-and-exit.html#cb71-10" tabindex="-1"></a>     <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;r&quot;</span><span class="op">,</span> <span class="st">&quot;20&quot;</span>)</span>
<span id="cb71-11"><a href="update-enter-and-exit.html#cb71-11" tabindex="-1"></a>     <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb71-12"><a href="update-enter-and-exit.html#cb71-12" tabindex="-1"></a>  <span class="op">.</span><span class="fu">merge</span>(circ)</span>
<span id="cb71-13"><a href="update-enter-and-exit.html#cb71-13" tabindex="-1"></a>     <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb71-14"><a href="update-enter-and-exit.html#cb71-14" tabindex="-1"></a>     <span class="op">.</span><span class="fu">duration</span>(<span class="dv">2000</span>)</span>
<span id="cb71-15"><a href="update-enter-and-exit.html#cb71-15" tabindex="-1"></a>     <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;cx&quot;</span><span class="op">,</span> <span class="st">&quot;200&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>Note the pattern:</p>
<ul>
<li>Create a data array</li>
<li>Store the svg selection</li>
<li>Store the data bind in X</li>
</ul>
<pre><code>X.enter()
  .append(some shape)
  *add attributes*  // acts on enter selection only (no transitions!)
  .merge(X)
  *attributes, other stuff* // acts on enter and update selections</code></pre>
<p><em>Do not include transitions in a stored selection!</em></p>
</div>
<div id="exercise-merge" class="section level2 hasAnchor" number="4.7">
<h2><span class="header-section-number">4.7</span> Exercise <i class="fas fa-dumbbell"></i>: merge<a href="update-enter-and-exit.html#exercise-merge" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Open <a href="code/horiz_bar.html" target="_blank">this bar chart</a> in Chrome and work in the Console. (You don’t have to download it.)</p>
<p>All of your solutions should begin with:</p>
<ul>
<li>Creating a data array (ex. <code>const dataset = [1, 2, 3];</code>)</li>
<li>Selecting the <code>svg</code> and storing it (<code>const svg = d3.select("svg");</code>)</li>
<li>Binding the data and storing it (ex. <code>const bars = svg.selectAll("rect").data(dataset));</code>)</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Change the data to any six other values and update the lengths of the bars.</p></li>
<li><p>Bind a new dataset, <code>newbardata</code> to the bars, update the bar lengths, and remove any extra bars.</p>
<p><code>newbardata = [250, 125, 80, 100];</code></p></li>
<li><p>Bind a new dataset, <code>reallynewbardata</code>, to the bars, then add additional bars so each data value has a bar. Make the outline (stroke) of the new bars a different color.</p>
<p><code>reallynewbardata = [300, 100, 250, 50, 200, 150, 325, 275];</code></p></li>
<li><p>Use <code>.merge()</code> to combine the update and enter selections into one selection and then transition the height of all of the bars to half their current height.</p></li>
<li><p>Add text labels inside the bars at the right end with the length of the bar in pixels.</p></li>
</ol>
<p><a href="solutions.html#update-enter-and-exit-merge">Solution</a></p>
</div>
<div id="groups" class="section level2 hasAnchor" number="4.8">
<h2><span class="header-section-number">4.8</span> Groups <i class="fa fa-object-group"></i><a href="update-enter-and-exit.html#groups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Open <a href="code/six_blue_circles.html" target="_blank">six_blue_circles.html</a> in Chrome.</p>
<p>Run this code in the Console:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb73-1"><a href="update-enter-and-exit.html#cb73-1" tabindex="-1"></a><span class="kw">const</span> specialdata <span class="op">=</span> [<span class="dv">100</span><span class="op">,</span> <span class="dv">250</span><span class="op">,</span> <span class="dv">300</span>]<span class="op">;</span></span>
<span id="cb73-2"><a href="update-enter-and-exit.html#cb73-2" tabindex="-1"></a></span>
<span id="cb73-3"><a href="update-enter-and-exit.html#cb73-3" tabindex="-1"></a><span class="kw">const</span> bars <span class="op">=</span> </span>
<span id="cb73-4"><a href="update-enter-and-exit.html#cb73-4" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb73-5"><a href="update-enter-and-exit.html#cb73-5" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb73-6"><a href="update-enter-and-exit.html#cb73-6" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(specialdata)</span>
<span id="cb73-7"><a href="update-enter-and-exit.html#cb73-7" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb73-8"><a href="update-enter-and-exit.html#cb73-8" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb73-9"><a href="update-enter-and-exit.html#cb73-9" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)</span>
<span id="cb73-10"><a href="update-enter-and-exit.html#cb73-10" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;y&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)</span>
<span id="cb73-11"><a href="update-enter-and-exit.html#cb73-11" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;width&quot;</span><span class="op">,</span> <span class="st">&quot;50&quot;</span>)</span>
<span id="cb73-12"><a href="update-enter-and-exit.html#cb73-12" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;height&quot;</span><span class="op">,</span> <span class="st">&quot;30&quot;</span>)</span>
<span id="cb73-13"><a href="update-enter-and-exit.html#cb73-13" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;red&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>What’s going on?</p>
<p>Refresh the page, and try the following instead:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb74-1"><a href="update-enter-and-exit.html#cb74-1" tabindex="-1"></a><span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)<span class="op">;</span></span>
<span id="cb74-2"><a href="update-enter-and-exit.html#cb74-2" tabindex="-1"></a></span>
<span id="cb74-3"><a href="update-enter-and-exit.html#cb74-3" tabindex="-1"></a><span class="kw">const</span> specialdata <span class="op">=</span> [<span class="dv">100</span><span class="op">,</span> <span class="dv">250</span><span class="op">,</span> <span class="dv">300</span>]<span class="op">;</span></span>
<span id="cb74-4"><a href="update-enter-and-exit.html#cb74-4" tabindex="-1"></a></span>
<span id="cb74-5"><a href="update-enter-and-exit.html#cb74-5" tabindex="-1"></a><span class="kw">const</span> bars <span class="op">=</span> </span>
<span id="cb74-6"><a href="update-enter-and-exit.html#cb74-6" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb74-7"><a href="update-enter-and-exit.html#cb74-7" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;g&quot;</span>)</span>
<span id="cb74-8"><a href="update-enter-and-exit.html#cb74-8" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;id&quot;</span><span class="op">,</span> <span class="st">&quot;rects&quot;</span>)</span>
<span id="cb74-9"><a href="update-enter-and-exit.html#cb74-9" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb74-10"><a href="update-enter-and-exit.html#cb74-10" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(specialdata)</span>
<span id="cb74-11"><a href="update-enter-and-exit.html#cb74-11" tabindex="-1"></a>    <span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb74-12"><a href="update-enter-and-exit.html#cb74-12" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb74-13"><a href="update-enter-and-exit.html#cb74-13" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)</span>
<span id="cb74-14"><a href="update-enter-and-exit.html#cb74-14" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;y&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)</span>
<span id="cb74-15"><a href="update-enter-and-exit.html#cb74-15" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;width&quot;</span><span class="op">,</span> <span class="st">&quot;50&quot;</span>)</span>
<span id="cb74-16"><a href="update-enter-and-exit.html#cb74-16" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;height&quot;</span><span class="op">,</span> <span class="st">&quot;30&quot;</span>)</span>
<span id="cb74-17"><a href="update-enter-and-exit.html#cb74-17" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;red&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>Compare:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb75-1"><a href="update-enter-and-exit.html#cb75-1" tabindex="-1"></a>d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb75-2"><a href="update-enter-and-exit.html#cb75-2" tabindex="-1"></a>  <span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;g#rects&quot;</span>)</span>
<span id="cb75-3"><a href="update-enter-and-exit.html#cb75-3" tabindex="-1"></a>  <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb75-4"><a href="update-enter-and-exit.html#cb75-4" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;purple&quot;</span>)<span class="op">;</span></span></code></pre></div>
<p>and</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb76-1"><a href="update-enter-and-exit.html#cb76-1" tabindex="-1"></a>d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb76-2"><a href="update-enter-and-exit.html#cb76-2" tabindex="-1"></a>  <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb76-3"><a href="update-enter-and-exit.html#cb76-3" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;purple&quot;</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div id="general-update-pattern-with-merge" class="section level2 hasAnchor" number="4.9">
<h2><span class="header-section-number">4.9</span> General Update Pattern (with merge)<a href="update-enter-and-exit.html#general-update-pattern-with-merge" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Open Developer Tools on this page.</p>
<svg id="gup">
</svg>
<script>
  d3.select("svg#gup")
    .attr("width", "500")
    .attr("height", "500");

  const bardata = [300, 100, 150, 225, 75, 275];

  const bars = 
    d3.select("svg")
      .selectAll("rect")
      .data(bardata);

  bars.enter()
    .append("rect")
      .attr("x", "30")
      .attr("y", (d, i) => i*50)
      .attr("width", d => d)
      .attr("height", "35")
      .attr("fill", "lightgreen");
</script>
<p>Create a function in the Console:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb77-1"><a href="update-enter-and-exit.html#cb77-1" tabindex="-1"></a><span class="kw">function</span> <span class="fu">changedata</span>(data) {</span>
<span id="cb77-2"><a href="update-enter-and-exit.html#cb77-2" tabindex="-1"></a>  d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg#gup&quot;</span>)</span>
<span id="cb77-3"><a href="update-enter-and-exit.html#cb77-3" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb77-4"><a href="update-enter-and-exit.html#cb77-4" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(data)</span>
<span id="cb77-5"><a href="update-enter-and-exit.html#cb77-5" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;width&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb77-6"><a href="update-enter-and-exit.html#cb77-6" tabindex="-1"></a>    }</span></code></pre></div>
<p>Test it out:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb78-1"><a href="update-enter-and-exit.html#cb78-1" tabindex="-1"></a><span class="fu">changedata</span>([<span class="dv">258</span><span class="op">,</span> <span class="dv">373</span><span class="op">,</span> <span class="dv">278</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="dv">72</span><span class="op">,</span> <span class="dv">96</span>])<span class="op">;</span></span></code></pre></div>
<p>What happens if there are too many data values?</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb79-1"><a href="update-enter-and-exit.html#cb79-1" tabindex="-1"></a><span class="fu">changedata</span>([<span class="dv">196</span><span class="op">,</span> <span class="dv">360</span><span class="op">,</span> <span class="dv">283</span><span class="op">,</span> <span class="dv">390</span><span class="op">,</span> <span class="dv">46</span><span class="op">,</span> <span class="dv">56</span><span class="op">,</span> <span class="dv">152</span>])<span class="op">;</span></span></code></pre></div>
<p>Let’s use the enter selection to add new bars in this case:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb80-1"><a href="update-enter-and-exit.html#cb80-1" tabindex="-1"></a><span class="kw">function</span> <span class="fu">changedata</span>(data) {</span>
<span id="cb80-2"><a href="update-enter-and-exit.html#cb80-2" tabindex="-1"></a>  <span class="kw">const</span> bars <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg#gup&quot;</span>) </span>
<span id="cb80-3"><a href="update-enter-and-exit.html#cb80-3" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb80-4"><a href="update-enter-and-exit.html#cb80-4" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(data)<span class="op">;</span>    <span class="co">// bars is the update selection</span></span>
<span id="cb80-5"><a href="update-enter-and-exit.html#cb80-5" tabindex="-1"></a>    </span>
<span id="cb80-6"><a href="update-enter-and-exit.html#cb80-6" tabindex="-1"></a>  bars<span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb80-7"><a href="update-enter-and-exit.html#cb80-7" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb80-8"><a href="update-enter-and-exit.html#cb80-8" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> <span class="st">&quot;30&quot;</span>)  <span class="co">// until merge, acts on</span></span>
<span id="cb80-9"><a href="update-enter-and-exit.html#cb80-9" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;y&quot;</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> i <span class="op">*</span> <span class="dv">50</span>) <span class="co">// enter selection only</span></span>
<span id="cb80-10"><a href="update-enter-and-exit.html#cb80-10" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;height&quot;</span><span class="op">,</span> <span class="st">&quot;35&quot;</span>)  </span>
<span id="cb80-11"><a href="update-enter-and-exit.html#cb80-11" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;lightgreen&quot;</span>)</span>
<span id="cb80-12"><a href="update-enter-and-exit.html#cb80-12" tabindex="-1"></a>    <span class="op">.</span><span class="fu">merge</span>(bars) <span class="co">// merge in the update selection</span></span>
<span id="cb80-13"><a href="update-enter-and-exit.html#cb80-13" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;width&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)<span class="op">;</span> <span class="co">// acts on all bars</span></span>
<span id="cb80-14"><a href="update-enter-and-exit.html#cb80-14" tabindex="-1"></a>  }</span></code></pre></div>
<p>What happens if we have more bars than data values?</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb81-1"><a href="update-enter-and-exit.html#cb81-1" tabindex="-1"></a><span class="fu">changedata</span>([<span class="dv">325</span><span class="op">,</span> <span class="dv">116</span><span class="op">,</span> <span class="dv">25</span>])<span class="op">;</span></span></code></pre></div>
<p>Let’s add to the function to remove the extra bars in this case:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb82-1"><a href="update-enter-and-exit.html#cb82-1" tabindex="-1"></a><span class="kw">function</span> <span class="fu">changedata</span>(data) {</span>
<span id="cb82-2"><a href="update-enter-and-exit.html#cb82-2" tabindex="-1"></a>  <span class="kw">const</span> bars <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;svg#gup&quot;</span>) </span>
<span id="cb82-3"><a href="update-enter-and-exit.html#cb82-3" tabindex="-1"></a>    <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb82-4"><a href="update-enter-and-exit.html#cb82-4" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(data)<span class="op">;</span>    <span class="co">// bars is the update selection</span></span>
<span id="cb82-5"><a href="update-enter-and-exit.html#cb82-5" tabindex="-1"></a>    </span>
<span id="cb82-6"><a href="update-enter-and-exit.html#cb82-6" tabindex="-1"></a>  bars<span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb82-7"><a href="update-enter-and-exit.html#cb82-7" tabindex="-1"></a>    <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb82-8"><a href="update-enter-and-exit.html#cb82-8" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> <span class="st">&quot;30&quot;</span>)  <span class="co">// until merge, acts on</span></span>
<span id="cb82-9"><a href="update-enter-and-exit.html#cb82-9" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;y&quot;</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> i <span class="op">*</span> <span class="dv">50</span>) <span class="co">// enter selection only</span></span>
<span id="cb82-10"><a href="update-enter-and-exit.html#cb82-10" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;height&quot;</span><span class="op">,</span> <span class="st">&quot;35&quot;</span>)  </span>
<span id="cb82-11"><a href="update-enter-and-exit.html#cb82-11" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;lightgreen&quot;</span>)</span>
<span id="cb82-12"><a href="update-enter-and-exit.html#cb82-12" tabindex="-1"></a>    <span class="op">.</span><span class="fu">merge</span>(bars) <span class="co">// merge in the update selection</span></span>
<span id="cb82-13"><a href="update-enter-and-exit.html#cb82-13" tabindex="-1"></a>      <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;width&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)<span class="op">;</span> <span class="co">// acts on all bars</span></span>
<span id="cb82-14"><a href="update-enter-and-exit.html#cb82-14" tabindex="-1"></a>      </span>
<span id="cb82-15"><a href="update-enter-and-exit.html#cb82-15" tabindex="-1"></a>  bars<span class="op">.</span><span class="fu">exit</span>()</span>
<span id="cb82-16"><a href="update-enter-and-exit.html#cb82-16" tabindex="-1"></a>    <span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb82-17"><a href="update-enter-and-exit.html#cb82-17" tabindex="-1"></a>  }</span></code></pre></div>
<p>Try:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb83-1"><a href="update-enter-and-exit.html#cb83-1" tabindex="-1"></a><span class="fu">changedata</span>([<span class="dv">271</span><span class="op">,</span> <span class="dv">49</span><span class="op">,</span> <span class="dv">389</span>])<span class="op">;</span></span></code></pre></div>
<p>VOILA! We have created the D3 General Update Pattern!</p>
<p>It is covered in <em>IDVW</em> in the “Other Kinds of Data Updates” section on pp. 178-186 in Chapter 9. (The earlier part of Chapter 9 deals with data updates in which the number of DOM elements remains the same.)</p>
<p><strong>Note that the General Update Pattern changed with D3 Version 4 so avoid examples from Version 3.</strong></p>
<p>Also available here: <a href="code/general_update_pattern.html" target="_blank">general_update_pattern.html</a></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb84-1"><a href="update-enter-and-exit.html#cb84-1" tabindex="-1"></a><span class="op">&lt;!</span>DOCTYPE html<span class="op">&gt;</span></span>
<span id="cb84-2"><a href="update-enter-and-exit.html#cb84-2" tabindex="-1"></a><span class="op">&lt;</span>html lang<span class="op">=</span><span class="st">&quot;en&quot;</span><span class="op">&gt;</span></span>
<span id="cb84-3"><a href="update-enter-and-exit.html#cb84-3" tabindex="-1"></a>  <span class="op">&lt;</span>head<span class="op">&gt;</span></span>
<span id="cb84-4"><a href="update-enter-and-exit.html#cb84-4" tabindex="-1"></a>    <span class="op">&lt;</span>meta charset<span class="op">=</span><span class="st">&quot;utf-8&quot;</span><span class="op">&gt;</span></span>
<span id="cb84-5"><a href="update-enter-and-exit.html#cb84-5" tabindex="-1"></a>    <span class="op">&lt;</span>script src<span class="op">=</span><span class="st">&quot;https://d3js.org/d3.v7.min.js&quot;</span><span class="op">&gt;&lt;/</span>script<span class="op">&gt;</span></span>
<span id="cb84-6"><a href="update-enter-and-exit.html#cb84-6" tabindex="-1"></a>  <span class="op">&lt;/</span>head<span class="op">&gt;</span></span>
<span id="cb84-7"><a href="update-enter-and-exit.html#cb84-7" tabindex="-1"></a></span>
<span id="cb84-8"><a href="update-enter-and-exit.html#cb84-8" tabindex="-1"></a>  <span class="op">&lt;</span>body<span class="op">&gt;</span></span>
<span id="cb84-9"><a href="update-enter-and-exit.html#cb84-9" tabindex="-1"></a></span>
<span id="cb84-10"><a href="update-enter-and-exit.html#cb84-10" tabindex="-1"></a><span class="op">&lt;</span>script id<span class="op">=</span><span class="st">&quot;s1&quot;</span><span class="op">&gt;</span></span>
<span id="cb84-11"><a href="update-enter-and-exit.html#cb84-11" tabindex="-1"></a></span>
<span id="cb84-12"><a href="update-enter-and-exit.html#cb84-12" tabindex="-1"></a><span class="co">// Create svg and initial bars</span></span>
<span id="cb84-13"><a href="update-enter-and-exit.html#cb84-13" tabindex="-1"></a></span>
<span id="cb84-14"><a href="update-enter-and-exit.html#cb84-14" tabindex="-1"></a><span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&quot;body&quot;</span>)</span>
<span id="cb84-15"><a href="update-enter-and-exit.html#cb84-15" tabindex="-1"></a>  <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;svg&quot;</span>)</span>
<span id="cb84-16"><a href="update-enter-and-exit.html#cb84-16" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;width&quot;</span><span class="op">,</span> <span class="st">&quot;500&quot;</span>)</span>
<span id="cb84-17"><a href="update-enter-and-exit.html#cb84-17" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;height&quot;</span><span class="op">,</span> <span class="st">&quot;400&quot;</span>)<span class="op">;</span></span>
<span id="cb84-18"><a href="update-enter-and-exit.html#cb84-18" tabindex="-1"></a></span>
<span id="cb84-19"><a href="update-enter-and-exit.html#cb84-19" tabindex="-1"></a><span class="kw">const</span> bardata <span class="op">=</span> [<span class="dv">300</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="dv">150</span><span class="op">,</span> <span class="dv">225</span><span class="op">,</span> <span class="dv">75</span><span class="op">,</span> <span class="dv">275</span>]<span class="op">;</span></span>
<span id="cb84-20"><a href="update-enter-and-exit.html#cb84-20" tabindex="-1"></a></span>
<span id="cb84-21"><a href="update-enter-and-exit.html#cb84-21" tabindex="-1"></a><span class="kw">const</span> bars <span class="op">=</span> svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb84-22"><a href="update-enter-and-exit.html#cb84-22" tabindex="-1"></a>  <span class="op">.</span><span class="fu">data</span>(bardata)<span class="op">;</span></span>
<span id="cb84-23"><a href="update-enter-and-exit.html#cb84-23" tabindex="-1"></a></span>
<span id="cb84-24"><a href="update-enter-and-exit.html#cb84-24" tabindex="-1"></a>bars<span class="op">.</span><span class="fu">enter</span>()<span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;rect&quot;</span>)</span>
<span id="cb84-25"><a href="update-enter-and-exit.html#cb84-25" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> <span class="st">&quot;30&quot;</span>)</span>
<span id="cb84-26"><a href="update-enter-and-exit.html#cb84-26" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;y&quot;</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> i<span class="op">*</span><span class="dv">50</span>)</span>
<span id="cb84-27"><a href="update-enter-and-exit.html#cb84-27" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;width&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)</span>
<span id="cb84-28"><a href="update-enter-and-exit.html#cb84-28" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;height&quot;</span><span class="op">,</span> <span class="st">&quot;35&quot;</span>)</span>
<span id="cb84-29"><a href="update-enter-and-exit.html#cb84-29" tabindex="-1"></a>  <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;lightgreen&quot;</span>)<span class="op">;</span></span>
<span id="cb84-30"><a href="update-enter-and-exit.html#cb84-30" tabindex="-1"></a></span>
<span id="cb84-31"><a href="update-enter-and-exit.html#cb84-31" tabindex="-1"></a><span class="co">// General Update Pattern</span></span>
<span id="cb84-32"><a href="update-enter-and-exit.html#cb84-32" tabindex="-1"></a></span>
<span id="cb84-33"><a href="update-enter-and-exit.html#cb84-33" tabindex="-1"></a><span class="kw">function</span> <span class="fu">update</span>(data) {</span>
<span id="cb84-34"><a href="update-enter-and-exit.html#cb84-34" tabindex="-1"></a></span>
<span id="cb84-35"><a href="update-enter-and-exit.html#cb84-35" tabindex="-1"></a>  <span class="kw">const</span> bars <span class="op">=</span> svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">&quot;rect&quot;</span>)    <span class="co">// data join</span></span>
<span id="cb84-36"><a href="update-enter-and-exit.html#cb84-36" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(data)<span class="op">;</span></span>
<span id="cb84-37"><a href="update-enter-and-exit.html#cb84-37" tabindex="-1"></a></span>
<span id="cb84-38"><a href="update-enter-and-exit.html#cb84-38" tabindex="-1"></a>    bars<span class="op">.</span><span class="fu">enter</span>()</span>
<span id="cb84-39"><a href="update-enter-and-exit.html#cb84-39" tabindex="-1"></a>      <span class="op">.</span><span class="fu">append</span>(<span class="st">&quot;rect&quot;</span>)    <span class="co">// add new elements</span></span>
<span id="cb84-40"><a href="update-enter-and-exit.html#cb84-40" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;x&quot;</span><span class="op">,</span> <span class="st">&quot;30&quot;</span>)</span>
<span id="cb84-41"><a href="update-enter-and-exit.html#cb84-41" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;y&quot;</span><span class="op">,</span> (d<span class="op">,</span> i) <span class="kw">=&gt;</span> i<span class="op">*</span><span class="dv">50</span>)</span>
<span id="cb84-42"><a href="update-enter-and-exit.html#cb84-42" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;width&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)</span>
<span id="cb84-43"><a href="update-enter-and-exit.html#cb84-43" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;height&quot;</span><span class="op">,</span> <span class="st">&quot;35&quot;</span>)</span>
<span id="cb84-44"><a href="update-enter-and-exit.html#cb84-44" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;yellow&quot;</span>)</span>
<span id="cb84-45"><a href="update-enter-and-exit.html#cb84-45" tabindex="-1"></a>      <span class="op">.</span><span class="fu">merge</span>(bars)    <span class="co">// merge</span></span>
<span id="cb84-46"><a href="update-enter-and-exit.html#cb84-46" tabindex="-1"></a>        <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb84-47"><a href="update-enter-and-exit.html#cb84-47" tabindex="-1"></a>        <span class="op">.</span><span class="fu">duration</span>(<span class="dv">2000</span>)</span>
<span id="cb84-48"><a href="update-enter-and-exit.html#cb84-48" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;width&quot;</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)</span>
<span id="cb84-49"><a href="update-enter-and-exit.html#cb84-49" tabindex="-1"></a>        <span class="op">.</span><span class="fu">attr</span>(<span class="st">&quot;fill&quot;</span><span class="op">,</span> <span class="st">&quot;orange&quot;</span>)<span class="op">;</span></span>
<span id="cb84-50"><a href="update-enter-and-exit.html#cb84-50" tabindex="-1"></a></span>
<span id="cb84-51"><a href="update-enter-and-exit.html#cb84-51" tabindex="-1"></a>    bars<span class="op">.</span><span class="fu">exit</span>()<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span>    <span class="co">// remove extra elements</span></span>
<span id="cb84-52"><a href="update-enter-and-exit.html#cb84-52" tabindex="-1"></a>    }</span>
<span id="cb84-53"><a href="update-enter-and-exit.html#cb84-53" tabindex="-1"></a></span>
<span id="cb84-54"><a href="update-enter-and-exit.html#cb84-54" tabindex="-1"></a>    <span class="op">&lt;/</span>script<span class="op">&gt;</span></span>
<span id="cb84-55"><a href="update-enter-and-exit.html#cb84-55" tabindex="-1"></a></span>
<span id="cb84-56"><a href="update-enter-and-exit.html#cb84-56" tabindex="-1"></a>  <span class="op">&lt;/</span>body<span class="op">&gt;</span></span>
<span id="cb84-57"><a href="update-enter-and-exit.html#cb84-57" tabindex="-1"></a></span>
<span id="cb84-58"><a href="update-enter-and-exit.html#cb84-58" tabindex="-1"></a><span class="op">&lt;/</span>html<span class="op">&gt;</span></span></code></pre></div>
</div>
<div id="general-update-pattern-with-join" class="section level2 hasAnchor" number="4.10">
<h2><span class="header-section-number">4.10</span> General Update Pattern (with join)<a href="update-enter-and-exit.html#general-update-pattern-with-join" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Optional</strong></p>
<p>This is a newer method–introduced in v5–which simplifies the general update pattern by automatically adding elements for the enter selection, removing elements for the exit selection, merging the enter and update selections and then acting on them all with <code>.join()</code>.</p>
<p>The update pattern above could be replaced with the following:</p>
<pre><code>function changedata2(data) {
  const svg = d3.select(&quot;svg#gup&quot;) 
  svg.selectAll(&quot;rect&quot;)
    .data(data)
    .join(&quot;rect&quot;) // need &quot;rect&quot; for appending elements
      .attr(&quot;x&quot;, &quot;30&quot;)  
      .attr(&quot;y&quot;, (d, i) =&gt; i * 50)
      .attr(&quot;height&quot;, &quot;35&quot;)  
      .attr(&quot;fill&quot;, &quot;lightgreen&quot;)
      .attr(&quot;width&quot;, d =&gt; d);
  }</code></pre>
<p>Try:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb86-1"><a href="update-enter-and-exit.html#cb86-1" tabindex="-1"></a><span class="fu">changedata2</span>([<span class="dv">271</span><span class="op">,</span> <span class="dv">49</span><span class="op">,</span> <span class="dv">389</span>])<span class="op">;</span></span></code></pre></div>
<p>With <code>.join()</code> you can get more granular with <strong>enter</strong>, <strong>update</strong>, and <strong>exit</strong> selections as we did previously. <code>changedata3()</code> is equivalent to <code>changedata2()</code>:</p>
<pre><code>function changedata3(data) {
  const svg = d3.select(&quot;svg#gup&quot;) 
  svg.selectAll(&quot;rect&quot;)
    .data(data)
    .join(
      enter =&gt; enter.append(&quot;rect&quot;)
        .attr(&quot;x&quot;, &quot;30&quot;)  
        .attr(&quot;y&quot;, (d, i) =&gt; i * 50)
        .attr(&quot;height&quot;, &quot;35&quot;)
        .attr(&quot;width&quot;, d =&gt; d)
        .attr(&quot;fill&quot;, &quot;lightgreen&quot;),
      update =&gt; update
        .attr(&quot;width&quot;, d =&gt; d),
      exit =&gt; exit.remove()
      );
  }</code></pre>
<p>Generally, however, unless you have <a href="transitions.html" target="_blank">transitions</a>, you will not need to control the enter, exit and update selections separately.</p>
</div>
<div id="exercise-functions" class="section level2 hasAnchor" number="4.11">
<h2><span class="header-section-number">4.11</span> Exercise: <i class="fas fa-dumbbell"></i>: functions<a href="update-enter-and-exit.html#exercise-functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Open <a href="code/general_update_pattern.html" target="_blank">general_update_pattern.html</a> and practice running the <code>update()</code> function with different datasets in the Console.</p>
<p>For example:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb88-1"><a href="update-enter-and-exit.html#cb88-1" tabindex="-1"></a><span class="fu">update</span>([<span class="dv">100</span><span class="op">,</span> <span class="dv">200</span><span class="op">,</span> <span class="dv">300</span>])<span class="op">;</span></span></code></pre></div>
<p><a href="solutions.html#update-enter-and-exit-functions">Solution</a></p>
</div>
<div id="exercise-vertical-bar-chart" class="section level2 hasAnchor" number="4.12">
<h2><span class="header-section-number">4.12</span> Exercise <i class="fas fa-dumbbell"></i>: vertical bar chart<a href="update-enter-and-exit.html#exercise-vertical-bar-chart" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Save a copy of <a href="https://raw.githubusercontent.com/jtr13/d3book/main/code/bar_chart_exercise.html" target="_blank">this exercise</a> and open it in your text editor.</li>
</ol>
<p>Create a <strong>vertical</strong> bar chart with bar heights equal to the data values stored in <code>bardata</code>. Do so by replacing all the “ADD’s” with constants or functions and then uncommenting those lines.</p>
<p><a href="solutions.html#update-enter-and-exit-vertical-bar-chart">Solution</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="d3console.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="just-enough-js.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jtr13/d3book/edit/main/update.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jtr13/d3book/blob/main/update.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
